
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>極軌衛星發射載具 PSLV Neutron | Web 3D + AR</title>
  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>
  <style>
    html, body { margin:0; height:100%; }
    model-viewer { width:100vw; height:100vh; display:block; }
    /* 置頂按鈕列（並列） */
    #topBar{
      position: fixed; left:0; right:0;
      top: calc(8px + env(safe-area-inset-top, 0px));
      z-index: 10000; display:flex; justify-content:center; gap:10px;
      pointer-events: none;
    }
    .topBtn{
      pointer-events:auto;
      padding:10px 14px; border-radius:999px; border:1px solid #ddd;
      background:#111; color:#fff; text-decoration:none; font-size:14px;
      box-shadow:0 2px 10px rgba(0,0,0,.2);
    }
    .topBtn[disabled]{
      opacity:.5; cursor:not-allowed;
    }
    /* in-app 提示（LINE/FB 內建瀏覽器） */
    #inappTip{
      position:fixed; left:0; right:0; top:0;
      padding:10px; background:#fff3cd; border-bottom:1px solid #ffeeba;
      font-size:14px; text-align:center; z-index:10001; display:none;
    }
  </style>
</head>
<body>

  <!-- 置頂雙按鈕：Android／iOS 並列 -->
  <div id="topBar">
    <button id="openARAndroid" class="topBtn">🤖 Android | AR</button>
    <a id="openARiOS" class="topBtn" rel="ar" target="_blank" href="model_ele.usdz">📱 iOS | AR</a>
  </div>
  <div id="inappTip">請用「 Chrome/Safari 開啟」再試，iOS AR 在 LINE/FB 內建瀏覽器常無法啟動。</div>

  <model-viewer
    src="model_psl.glb"
    ios-src="model_psl.usdz"
    alt="PSLV"
    ar
    ar-modes="webxr scene-viewer quick-look"
    camera-controls
    auto-rotate
    shadow-intensity="1">
    <!-- 不再使用 slot 的預設 AR 按鈕，避免畫面多一顆陽春按鈕 -->
  </model-viewer>

  <script>
    const mv = document.querySelector('model-viewer');
    const btnAndroid = document.getElementById('openARAndroid');
    const btnIOS = document.getElementById('openARiOS');

    // Android 按鈕 → 直接觸發 model-viewer 的 AR
    btnAndroid.addEventListener('click', () => {
      try { mv.activateAR(); } catch (e) { /* 裝置不支援就無動作 */ }
    });

    // 環境偵測（僅用來啟用/停用按鈕與顯示提示，不改變你的原本行為）
    const ua = navigator.userAgent;
    const isiOS = /iPhone|iPad|iPod/.test(ua);
    const isAndroid = /Android/i.test(ua);
    const inApp = /(Line|FBAV|FBAN|FBIOS|Instagram|GSA|Twitter|Snapchat)/i.test(ua);

    // 若非 Android，將 Android 鈕設為 disabled（避免 iOS 點了沒反應）
    if (!isAndroid) btnAndroid.setAttribute('disabled', 'true');
    // 若非 iOS，可把 iOS 鈕灰掉（仍可點開檔案，但多半沒用）
    if (!isiOS) btnIOS.setAttribute('disabled', 'true');

    // in-app 瀏覽器顯示提示（LINE/FB）
    if (inApp) document.getElementById('inappTip').style.display = 'block';
  </script>

</body>
</html>
